library("ggplot2", lib.loc="~/R/win-library/3.4")
library(dplyr)
library(readxl)
library(Amelia)


data <- read.csv('../data/sortie.csv', sep=',', header=TRUE)

sapply(data,function(x) sum(is.na(x)))
sapply(data, function(x) length(unique(x)))

missmap(data, main = "Missing values vs observed")

names(data)
#[1] "X"                    "parlementaire"        "groupe_sigle"         "sexe_parlementaire"  
#[5] "contrat_mediane"      "nb_collaborateurs"    "duree_mandat"         "contrat_max"         
#[9] "contrat_min"          "ratio_contrat_mandat" "parlementaire_femme"  "parlementaire_homme" 
#[13] "groupe_GDR"           "groupe_NI"            "groupe_LR"            "groupe_LREM"         
#[17] "groupe_SOC"            "groupe_UAI"           "groupe_MODEM"         "groupe_LFI"     




reg <- glm(contrat_mediane ~ parlementaire_femme  + groupe_LREM + groupe_GDR + groupe_NI + groupe_LR + groupe_LREM + groupe_SOC + groupe_UAI + groupe_MODEM + groupe_LFI, data=data) 
summary(reg)

data2 <- read.csv('../data/turnover_collaborateurs_variables.csv', sep=',', header=TRUE)
names(data2)
#[1] "X"                               "parlementaire"                   "nom_parlementaire"              
#[4] "prÃ.nom_parlementaire"           "sexe_parlementaire_x"            "collaborateur"                  
#[7] "nom_collaborateur"               "prÃ.nom_collaborateur"           "sexe_collaborateur"             
#[10] "url_nosdeputes_api"              "url_institution"                 "information.complÃ.mentaire"    
#[13] "date.action"                     "id"                              "nom"                            
#[16] "nom_de_famille"                  "prenom"                          "sexe"                           
#[19] "date_naissance"                  "lieu_naissance"                  "num_deptmt"                     
#[22] "nom_circo"                       "num_circo"                       "mandat_debut"                   
#[25] "mandat_fin"                      "ancien_depute_x"                 "groupe_sigle_x"                 
#[28] "parti_ratt_financier"            "sites_web"                       "emails"                         
#[31] "adresses"                        "autres_mandats"                  "anciens_autres_mandats"         
#[34] "anciens_mandats"                 "profession"                      "place_en_hemicycle"             
#[37] "url_an"                          "id_an"                           "slug"                           
#[40] "url_nosdeputes"                  "nb_mandats_x"                    "entree"                         
#[43] "sortie"                          "nombredejours"                   "contrat_fini"                   
#[46] "duree_mandat_x"                  "parlementaire_age_x"             "groupe_sigle_y"                 
#[49] "sexe_parlementaire_y"            "contrat_mediane"                 "nb_collaborateurs"              
#[52] "duree_mandat_y"                  "contrat_max"                     "contrat_min"                    
#[55] "contrat_fini_max"                "contrat_fini_min"                "ancien_depute_y"                
#[58] "ratio_contrat_mandat"            "nb_mandats_y"                    "parlementaire_age_y"            
#[61] "parlementaire_femme"             "parlementaire_homme"             "parlementaire_has_autre_mandats"
#[64] "groupe_GDR"                      "groupe_NI"                       "groupe_LR"                      
#[67] "groupe_LREM"                     "groupe_SOC"                      "groupe_UAI"                     
#[70] "groupe_MODEM"                    "groupe_LFI" 

reg6 <- glm(contrat_mediane ~ parlementaire_femme  +  groupe_LREM + parlementaire_age + nb_mandats + groupe_GDR + groupe_NI + groupe_LR + groupe_LREM + groupe_SOC + groupe_UAI + groupe_MODEM + groupe_LFI, data=data2) 
summary(reg6)

reg7 <- glm(nombredejours ~ parlementaire_femme  + parlementaire_age + nb_mandats + groupe_GDR + groupe_NI + groupe_LR + groupe_LREM + groupe_SOC + groupe_UAI + groupe_MODEM + groupe_LFI, data=data2) 
summary(reg7)
#logistic.display(reg7)

library(vcd)
library(epiDisplay)
glm1 <- lm(nombredejours ~ parlementaire_femme  + parlementaire_age + collaborateur_homme +  nb_mandats + groupe_GDR + groupe_NI + groupe_LR + groupe_LREM + groupe_SOC + groupe_UAI + groupe_MODEM + groupe_LFI, data=data2) 

summary(glm1)

#library(lme4)
#lme1 <- lme(nombredejours ~ parlementaire_femme  + parlementaire_age + nb_mandats_y + groupe_GDR + groupe_NI + groupe_LR + groupe_LREM + groupe_SOC + groupe_UAI + groupe_MODEM + groupe_LFI, data=data2) 
